option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: application:application

files:
  "/opt/elasticbeanstalk/hooks/prebuild/01_install_nodejs.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      set -e
      # Install Node.js 18.x for building Next.js frontend
      # Check if Node.js is already installed
      if ! command -v node &> /dev/null; then
        echo "Installing Node.js 18.x..."
        # Try dnf first (Amazon Linux 2023), fallback to yum
        if command -v dnf &> /dev/null; then
          curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
          dnf install -y nodejs
        elif command -v yum &> /dev/null; then
          curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
          yum install -y nodejs
        else
          echo "ERROR: Neither dnf nor yum found"
          exit 1
        fi
      else
        echo "Node.js already installed: $(node --version)"
      fi
      
      # Verify installation
      echo "Node.js version: $(node --version)"
      echo "npm version: $(npm --version)"


